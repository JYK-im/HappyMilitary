<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í–‰êµ°(í–‰ë³µí•œ êµ°ìƒí™œ) | êµ°ìƒí™œì˜ ëª¨ë“  ì •ë³´</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; background-color: #121418; color: #e1e1e1; overflow-x: hidden; }
        .accent-khaki { color: #8a9a5b; } 
        .bg-card { background-color: #1c1f26; border: 1px solid #2d333e; }
        .btn-khaki { background-color: #8a9a5b; color: #121418; font-weight: bold; }
        /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #121418; }
        ::-webkit-scrollbar-thumb { background: #2d333e; border-radius: 5px; }
    </style>
</head>
<body class="p-4 md:p-6">

    <header class="max-w-7xl mx-auto flex justify-between items-center py-6 mb-8 border-b border-gray-800">
        <div class="flex items-center gap-3">
            <div class="bg-[#8a9a5b] p-2 rounded-lg shadow-lg shadow-khaki/20">
                <i class="fa-solid fa-person-military-pointing text-black text-2xl"></i>
            </div>
            <div>
                <h1 class="text-3xl font-black text-white tracking-tighter">
                    <span class="accent-khaki text-[40px]">í–‰</span>ë³µí•œ 
                    <span class="accent-khaki text-[40px]">êµ°</span>ìƒí™œ
                </h1>
                <p class="text-[10px] text-gray-500 font-bold tracking-widest uppercase italic leading-none mt-1">Happy Military Community</p>
            </div>
        </div>
        <div id="authArea" class="flex items-center gap-3">
            <div class="hidden md:flex gap-2">
                <button onclick="alert('ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì¤€ë¹„ ì¤‘')" class="bg-[#FEE500] text-black text-[10px] px-3 py-1.5 rounded-full font-bold">ì¹´ì¹´ì˜¤</button>
                <button onclick="alert('ë„¤ì´ë²„ ë¡œê·¸ì¸ ì¤€ë¹„ ì¤‘')" class="bg-[#03C75A] text-white text-[10px] px-3 py-1.5 rounded-full font-bold">ë„¤ì´ë²„</button>
            </div>
            <button id="loginBtn" class="text-xs bg-white text-black px-5 py-2 rounded-full font-bold hover:bg-gray-200 transition-all">êµ¬ê¸€ ë¡œê·¸ì¸</button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto grid grid-cols-1 xl:grid-cols-4 gap-6">
        
        <div class="xl:col-span-1 space-y-6">
            <section class="bg-card p-5 rounded-2xl shadow-xl">
                <h2 class="text-sm font-bold mb-4 accent-khaki flex items-center gap-2 border-b border-gray-800 pb-2">
                    <i class="fa-solid fa-fire"></i> ì‹¤ì‹œê°„ ì¸ê¸°ê¸€
                </h2>
                <div id="hotPosts" class="space-y-4 text-xs">
                    <div class="group cursor-pointer">
                        <p class="font-bold truncate group-hover:text-[#8a9a5b]">2026ë…„ êµ°ì¸ ì›”ê¸‰ ì§€ê¸‰ì¼ ë° ì¸ìƒë¶„ ì •ë¦¬</p>
                        <span class="text-[10px] text-gray-600">ëŒ“ê¸€ 32ê°œ Â· 10ë¶„ ì „</span>
                    </div>
                    <div class="group cursor-pointer">
                        <p class="font-bold truncate group-hover:text-[#8a9a5b]">ì˜ì™¸ë§ˆíŠ¸(WA) ê°€ì¡± ë“±ë¡ ì ˆì°¨ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</p>
                        <span class="text-[10px] text-gray-600">ëŒ“ê¸€ 18ê°œ Â· 25ë¶„ ì „</span>
                    </div>
                </div>
            </section>

            <section class="space-y-3">
                <a href="https://blog.naver.com" target="_blank" class="block bg-card p-4 rounded-xl border border-gray-800 hover:border-[#8a9a5b] transition-all group">
                    <p class="text-[10px] accent-khaki font-bold mb-1">í–‰êµ° ê³µì‹ ë¸”ë¡œê·¸</p>
                    <p class="font-bold text-sm group-hover:underline text-white">êµ°ì¸ê°€ì¡± í˜œíƒ ê°€ì´ë“œ ë³´ê¸°</p>
                </a>
                <a href="https://www.welfare.mil.kr/kukinfo/board/board.do?forwardName=kukinfo.board.list&be_id=h_package&ssv=bm_title&sm=OR&kw=&ct=0&cateCd1=0&area_cd1=" class="block bg-[#8a9a5b] p-4 rounded-xl text-black transition-transform hover:scale-[1.02]">
                    <p class="text-[10px] font-bold opacity-80">ì¶”ì²œ ì„œë¹„ìŠ¤</p>
                    <p class="font-bold text-sm">êµ­ë°©ë³µì§€ë‹¨ í˜œíƒ í™•ì¸</p>
                </a>
            </section>
        </div>

        <div class="xl:col-span-2 space-y-6">
            
            <section class="bg-card p-6 rounded-2xl shadow-lg border-b border-[#8a9a5b]/30">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        <i class="fa-solid fa-thumbtack accent-khaki"></i> ì£¼ìš” ì •ë³´ ì—…ë°ì´íŠ¸
                    </h2>
                    <button class="text-[10px] text-gray-500 hover:text-white transition-colors">ì „ì²´ë³´ê¸° +</button>
                </div>
                
                <div class="grid grid-cols-1 gap-4">
                    <div class="group cursor-pointer p-4 bg-black/20 rounded-xl border border-gray-800 hover:border-[#8a9a5b] transition-all">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[9px] bg-[#8a9a5b] text-black px-2 py-0.5 rounded font-bold uppercase tracking-tighter">ì´ˆê¸‰ê°„ë¶€</span>
                            <span class="text-[10px] text-gray-600 font-medium">2026.01.05</span>
                        </div>
                        <h3 class="font-bold text-sm group-hover:text-[#8a9a5b] mb-1">2026ë…„ ì´ˆê¸‰ê°„ë¶€ ë‹¹ì§ê·¼ë¬´ë¹„ ì¸ìƒ í™•ì • ë° ì§€ê¸‰ ì‹œê¸° ì•ˆë‚´</h3>
                        <p class="text-[11px] text-gray-500 line-clamp-1 leading-relaxed">ì˜¬í•´ë¶€í„° í‰ì¼ 2ë§Œì›, ì£¼ë§ 4ë§Œì›ìœ¼ë¡œ ì¸ìƒëœ ë‹¹ì§ë¹„ê°€ 1ì›” ê¸‰ì—¬ë¶€í„° ì†Œê¸‰ ì ìš©ë©ë‹ˆë‹¤.</p>
                    </div>

                    <div class="group cursor-pointer p-4 bg-black/20 rounded-xl border border-gray-800 hover:border-[#8a9a5b] transition-all">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[9px] bg-blue-600 text-white px-2 py-0.5 rounded font-bold uppercase tracking-tighter">êµ°ì¸ê°€ì¡±</span>
                            <span class="text-[10px] text-gray-600 font-medium">2026.01.03</span>
                        </div>
                        <h3 class="font-bold text-sm group-hover:text-[#8a9a5b] mb-1">êµ°ì¸ ìë…€ êµìœ¡ì§€ì›ê¸ˆ ë° í˜¸êµ­ì¥í•™ê¸ˆ ì‹ ì²­ ì„œë¥˜ ì•ˆë‚´</h3>
                        <p class="text-[11px] text-gray-500 line-clamp-1 leading-relaxed">ìë…€ ì¥í•™ê¸ˆ ì‹ ì²­ì„ ìœ„í•œ ë³µë¬´í™•ì¸ì„œ ë° ì„±ì  ì¦ëª…ì„œ ì œì¶œ ê¸°í•œì„ í™•ì¸í•˜ì„¸ìš”.</p>
                    </div>
                </div>
            </section>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <section class="bg-card p-6 rounded-2xl shadow-xl border-b border-[#8a9a5b]/30">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                        <h3 class="text-xl font-bold flex items-center gap-2">
                            <i class="fa-solid fa-cart-shopping accent-khaki"></i> ì˜ì™¸ë§ˆíŠ¸(WA) í˜„í™©
                        </h3>
                        <div class="relative w-full md:w-40">
                            <input type="text" id="waSearch" placeholder="ì§€ì—­ëª… ê²€ìƒ‰" 
                                class="w-full bg-black/50 border border-gray-700 px-3 py-1.5 rounded-xl text-[10px] focus:border-[#8a9a5b] outline-none">
                        </div>
                    </div>
                    <div id="waList" class="grid grid-cols-1 gap-3 max-h-[400px] overflow-y-auto pr-2">
                        <p class="text-center py-10 text-gray-600 animate-pulse text-[10px]">ì •ë³´ ë™ê¸°í™” ì¤‘...</p>
                    </div>
                </section>

                <section class="bg-card p-5 rounded-2xl h-fit min-h-[300px]">
    <h3 class="text-sm font-bold mb-4 flex items-center gap-2 border-b border-gray-800 pb-2">
        <i class="fa-solid fa-house-user accent-khaki"></i> êµ° íŠ¹ë³„ê³µê¸‰ ê³µê³ 
    </h3>
    <ul id="aptNoticeList" class="text-[11px] space-y-3">
        <li class="text-center py-4 text-gray-600 animate-pulse">ìµœì‹  ê³µê³  ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>
    </ul>
    <div class="mt-4 pt-2 border-t border-gray-800 text-center">
        <a href="https://www.welfare.mil.kr/board/board.do?m_code=1179&be_id=c_apt" target="_blank" class="text-[10px] text-gray-500 hover:text-white underline">
            êµ­êµ°ë³µì§€í¬í„¸ì—ì„œ ë”ë³´ê¸°
        </a>
    </div>
</section>
            </div>
        </div>

        <div class="xl:col-span-1">
            <section class="bg-card p-5 rounded-2xl h-[650px] flex flex-col shadow-2xl relative overflow-hidden">
    <h2 class="text-sm font-bold mb-4 accent-khaki border-b border-gray-800 pb-2 uppercase tracking-widest flex items-center gap-2">
        <i class="fa-solid fa-comments text-[10px]"></i> Live Talk
    </h2>

    <div id="chatBlindOverlay" class="absolute inset-0 z-50 flex flex-col items-center justify-center bg-[#121418]/90 backdrop-blur-md transition-opacity duration-500">
        <i class="fa-solid fa-lock text-3xl mb-4 text-[#8a9a5b]"></i>
        <p class="text-xs font-bold text-white mb-2">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
        <p class="text-[11px] text-gray-500 mb-5 text-center px-6">í–‰êµ° ì»¤ë®¤ë‹ˆí‹° ëŒ€í™”ì— ì°¸ì—¬í•˜ë ¤ë©´<br>êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.</p>
        <button onclick="handleLogin()" class="btn-khaki px-6 py-2 rounded-full text-[11px] hover:scale-105 transition-transform">
            êµ¬ê¸€ ë¡œê·¸ì¸
        </button>
    </div>

    <div id="chatContentArea" class="flex-1 flex flex-col opacity-20 pointer-events-none select-none">
        <div id="msgBox" class="flex-1 overflow-y-auto space-y-4 mb-4 pr-1 text-[11px]">
            <div class="bg-black/30 p-3 rounded-xl border border-gray-800 text-center">
                <p class="text-gray-500 text-[10px]">ë³´ì•ˆ ê·œì •ì„ ì¤€ìˆ˜í•´ ì£¼ì„¸ìš” ğŸª–</p>
            </div>
        </div>
        <div class="mt-auto">
            <div class="flex gap-2">
                <input type="text" id="chatInput" placeholder="ë§¤ë„ˆ ì±„íŒ… ë¶€íƒë“œë¦½ë‹ˆë‹¤." 
                    class="flex-1 bg-black border border-gray-700 p-2.5 rounded-xl text-xs outline-none" disabled>
                <button onclick="sendChat()" class="btn-khaki px-4 rounded-xl opacity-50" disabled>
                    <i class="fa-solid fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
</section>
        </div>
    </main>

    <footer class="max-w-7xl mx-auto mt-12 py-8 border-t border-gray-800 text-center text-gray-600 text-[10px]">
        <p>Â© 2026 í–‰êµ°(Happy Military). All Rights Reserved.</p>
        <p class="mt-1 font-bold">ë³¸ ì‚¬ì´íŠ¸ëŠ” êµ°ì‚¬ë³´ì•ˆ ê·œì •ì„ ì¤€ìˆ˜í•˜ë©°, ë³´ì•ˆ ìœ„ë°° ê²Œì‹œë¬¼ì€ ì¦‰ì‹œ ì‚­ì œë©ë‹ˆë‹¤.</p>
    </footer>


<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<script>
    // 2. Firebase ì„¤ì • ë° ì´ˆê¸°í™” (í•œ ë²ˆë§Œ ì„ ì–¸)
    const firebaseConfig = {
        apiKey: "AIzaSyDaNMdpDXgiuELEO65Wk0PazVT2yeQeags",
        authDomain: "dividend-b090d.firebaseapp.com",
        projectId: "dividend-b090d",
        storageBucket: "dividend-b090d.appspot.com",
        messagingSenderId: "543720180150",
        appId: "1:543720180150:web:15073a1e9706bb1f949917",
        databaseURL: "https://dividend-b090d-default-rtdb.firebaseio.com"
    };

    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.database();
    let currentUser = null; 
    let allMarts = [];

function handleLogin() {
        // ì‹¤ì œ êµ¬ê¸€ ë¡œê·¸ì¸ ì—°ë™ ì „ê¹Œì§€ëŠ” í´ë¦­ ì‹œ ì¦‰ì‹œ í•´ì œë˜ë„ë¡ êµ¬ì„±
        currentUser = { name: "ìµëª…ì˜ ì „ìš°" }; 
        
        // 1. ì˜¤ë²„ë ˆì´ ìˆ¨ê¸°ê¸°
        const overlay = document.getElementById('chatBlindOverlay');
        overlay.classList.add('opacity-0');
        setTimeout(() => overlay.classList.add('hidden'), 500);

        // 2. ì±„íŒ…ì°½ í™œì„±í™”
        const chatArea = document.getElementById('chatContentArea');
        chatArea.classList.remove('opacity-20', 'pointer-events-none', 'select-none');
        
        const input = document.getElementById('chatInput');
        input.disabled = false;
        input.placeholder = "ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...";

        // 3. ìƒë‹¨ ë¡œê·¸ì¸ ë²„íŠ¼ ë³€ê²½
        document.getElementById('loginBtn').innerText = "ë¡œê·¸ì•„ì›ƒ";
        console.log("ë¡œê·¸ì¸ ì„±ê³µ: ì±„íŒ…ì°½ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }


    // 3. ë§ˆíŠ¸ ë°ì´í„° ë¡œë“œ (ìºì‹œ ìš°ì„  ë°©ì‹)
    async function loadMartData() {
        const listContainer = document.getElementById('waList');
        try {
            const snapshot = await db.ref('marts_cache').once('value');
            const cachedData = snapshot.val();

            // ìºì‹œê°€ 1ì‹œê°„ ì´ë‚´ì´ë©´ ì‚¬ìš©
            if (cachedData && (Date.now() - cachedData.lastUpdated < 3600000)) {
                console.log("Firebase ìºì‹œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.");
                allMarts = cachedData.rows;
                renderMarts(allMarts);
            } else {
                await fetchAndCacheMarts();
            }
        } catch (error) {
            console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, API ì‹œë„:", error);
            await fetchAndCacheMarts();
        }
    }

    // 4. êµ­ë°©ë¶€ API í˜¸ì¶œ ë° ìºì‹± (CORS ì—ëŸ¬ ë°©ì§€ í”„ë¡ì‹œ ì‚¬ìš©)
    async function fetchAndCacheMarts() {
        const myKey = "3231313637393730303336333832313035";
        const apiUrl = `https://openapi.mnd.go.kr/${myKey}/xml/TB_MND_MART_CURRENT/1/999/`;
        const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(apiUrl)}`;

        try {
            const response = await fetch(proxyUrl);
            const xmlText = await response.text();
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, "text/xml");
            const rows = Array.from(xmlDoc.querySelectorAll('row'));

            if (rows.length > 0) {
                allMarts = rows.map(row => ({
                    MART: row.querySelector('MART')?.textContent || "ì •ë³´ì—†ìŒ",
                    LOC: row.querySelector('LOC')?.textContent || "ì£¼ì†Œì—†ìŒ",
                    TEL: row.querySelector('TEL')?.textContent || ""
                }));

                // Firebase ê¶Œí•œì´ í—ˆìš©ëœ ê²½ìš°ì—ë§Œ ì €ì¥ (ì‹¤íŒ¨í•´ë„ í™”ë©´ì€ ë‚˜ì˜´)
                db.ref('marts_cache').set({
                    lastUpdated: Date.now(),
                    rows: allMarts
                }).catch(e => console.warn("ìºì‹œ ì €ì¥ ê¶Œí•œ ì—†ìŒ (ë¡œê·¸ì¸ í•„ìš”)"));

                renderMarts(allMarts);
            }
        } catch (e) {
            console.error("API í˜¸ì¶œ ì‹¤íŒ¨:", e);
        }
    }

    // 5. í†µí•© ë Œë”ë§ í•¨ìˆ˜
    function renderMarts(marts) {
        const listContainer = document.getElementById('waList');
        if (!listContainer) return;

        const now = new Date();
        const curTime = now.getHours() * 100 + now.getMinutes();
        const day = now.getDay();

        listContainer.innerHTML = marts.map(mart => {
            let status = { text: "ìš´ì˜ ì¢…ë£Œ", color: "text-red-500", dot: "bg-red-500" };
            let isHoliday = (day === 0); // ì¼ìš”ì¼ íœ´ë¬´ ê°€ì •
            let openTime = 900, closeTime = (day === 6) ? 1500 : 1800;

            if (!isHoliday && curTime >= openTime && curTime < closeTime) {
                status = (curTime >= 1200 && curTime < 1300) 
                    ? { text: "ì ì‹¬ ì‹œê°„", color: "text-yellow-500", dot: "bg-yellow-500" }
                    : { text: "ìš´ì˜ ì¤‘", color: "text-green-500", dot: "bg-green-500 animate-pulse" };
            }

            return `
                <div class="flex flex-col p-3 bg-black/20 rounded-xl border border-gray-800 hover:border-[#8a9a5b]/50 transition-all">
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="text-[12px] font-bold text-white">${mart.MART}</h4>
                        <span class="flex items-center gap-1 text-[9px] font-bold ${status.color}">
                            <span class="w-1.5 h-1.5 rounded-full ${status.dot}"></span>${status.text}
                        </span>
                    </div>
                    <p class="text-[9px] text-gray-500 truncate mb-2">${mart.LOC}</p>
                    <div class="flex justify-between items-center text-[9px]">
                         <span class="text-gray-600">Tel: ${mart.TEL || 'ì •ë³´ì—†ìŒ'}</span>
                         ${mart.TEL ? `<a href="tel:${mart.TEL}" class="accent-khaki font-bold">ì „í™”í•˜ê¸°</a>` : ''}
                    </div>
                </div>`;
        }).join('');
    }

// 4. íŠ¹ë³„ê³µê¸‰ ê³µê³  ë¡œë“œ í•¨ìˆ˜ (JSON ë°ì´í„° ì¶”ì¶œ ë°©ì‹ ì ìš©)
async function loadAptNotices() {
    const listContainer = document.getElementById('aptNoticeList');
    const targetUrl = "https://www.welfare.mil.kr/board/board.do?m_code=1179&be_id=c_apt";
    // íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì¶”ê°€í•˜ì—¬ ìºì‹œëœ ì‹¤íŒ¨ ê²°ê³¼ê°€ ì•„ë‹Œ ìƒˆ ë°ì´í„°ë¥¼ ê°•ì œ ìš”ì²­í•©ë‹ˆë‹¤.
    const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}&_=${Date.now()}`;

    try {
        const response = await fetch(proxyUrl);
        if (!response.ok) throw new Error('ë„¤íŠ¸ì›Œí¬ ì‘ë‹µ ì—ëŸ¬');
        
        const data = await response.json(); 
        if (!data || !data.contents) throw new Error('ë°ì´í„° ì‘ë‹µ ë¹„ì–´ìˆìŒ');
        
        const htmlText = data.contents; 
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlText, "text/html");
        
        // êµ­êµ°ë³µì§€í¬í„¸ ê²Œì‹œíŒì˜ í–‰(tr)ì„ ë” í¬ê´„ì ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤.
        const rows = doc.querySelectorAll("table tr");
        let noticeHtml = "";
        let foundCount = 0;

        if (rows && rows.length > 0) {
            rows.forEach((row) => {
                // ìƒìœ„ 5ê°œë§Œ ê°€ì ¸ì˜¤ë©°, ì œëª©ì´ ìˆëŠ” ì¹¸ë§Œ ê³¨ë¼ëƒ…ë‹ˆë‹¤.
                const link = row.querySelector("a");
                if (link && foundCount < 5) {
                    const title = link.innerText.trim();
                    // ê³µì§€ì‚¬í•­ì´ë‚˜ ìœ íš¨í•œ ì œëª©ì¸ ê²½ìš° (ë³´í†µ 5ì ì´ìƒ)
                    if (title.length > 5 && !title.includes("ìë°”ìŠ¤í¬ë¦½íŠ¸")) {
                        // ë‚ ì§œëŠ” í•´ë‹¹ í–‰ì˜ ë§ˆì§€ë§‰ì—ì„œ 2~3ë²ˆì§¸ tdì— ìœ„ì¹˜í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.
                        const tds = row.querySelectorAll("td");
                        const date = tds.length > 2 ? tds[tds.length - 2].innerText.trim() : "";

                        noticeHtml += `
                            <li class="group border-b border-gray-800/50 pb-2 last:border-0">
                                <a href="${targetUrl}" target="_blank" class="block group-hover:text-[#8a9a5b] transition-colors">
                                    <p class="truncate leading-tight text-white/90 font-medium">â€¢ ${title}</p>
                                    <div class="flex justify-between items-center mt-1">
                                        <span class="text-[9px] text-gray-500 italic">${date}</span>
                                        <span class="text-[8px] accent-khaki opacity-0 group-hover:opacity-100 transition-opacity">ìì„¸íˆ ë³´ê¸° ></span>
                                    </div>
                                </a>
                            </li>`;
                        foundCount++;
                    }
                }
            });
            
            if (foundCount > 0) {
                listContainer.innerHTML = noticeHtml;
            } else {
                throw new Error("ìœ íš¨í•œ ê²Œì‹œê¸€ì„ ì°¾ì§€ ëª»í•¨");
            }
        } else {
            throw new Error("í…Œì´ë¸” êµ¬ì¡° ì—†ìŒ");
        }
    } catch (error) {
        console.warn("ê³µê³  ë¡œë”© ì‹¤íŒ¨:", error.message);
        // ì‹¤íŒ¨ ì‹œ ë¬´í•œ ë¡œë”© í‘œì‹œ ëŒ€ì‹  ë²„íŠ¼ì„ ì¦‰ì‹œ ë…¸ì¶œí•˜ì—¬ ì‚¬ìš©ì ë¶ˆí¸ ìµœì†Œí™”
        listContainer.innerHTML = `
            <li class="py-4 text-center">
                <p class="text-[10px] text-gray-500 mb-3 leading-relaxed">ë³µì§€í¬í„¸ ì„œë²„ ì‘ë‹µì´ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                <a href="${targetUrl}" target="_blank" class="btn-khaki px-5 py-2 rounded-full text-[10px] inline-block shadow-lg hover:scale-105 transition-transform">
                    ì‹¤ì‹œê°„ ê³µê³  í™•ì¸í•˜ê¸°
                </a>
            </li>`;
    }
}
// 5. í˜ì´ì§€ ì´ˆê¸°í™” ë° ê²€ìƒ‰ ì´ë²¤íŠ¸ (í•¨ìˆ˜ í˜¸ì¶œ ë³´ì¥)
document.addEventListener('DOMContentLoaded', () => {
    loadMartData();   // ì˜ì™¸ë§ˆíŠ¸ ë¡œë“œ
    loadAptNotices(); // íŠ¹ë³„ê³µê¸‰ ë¡œë“œ
    
    // ê²€ìƒ‰ ê¸°ëŠ¥: renderMarts(allMarts) í˜¸ì¶œ
    document.getElementById('waSearch')?.addEventListener('input', (e) => {
        const val = e.target.value.toLowerCase();
        const filtered = allMarts.filter(m => m.MART.toLowerCase().includes(val) || m.LOC.toLowerCase().includes(val));
        renderMarts(filtered);
    });
});

// ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (1ë¶„ë§ˆë‹¤)
setInterval(() => { if(allMarts.length > 0) renderMarts(allMarts); }, 60000);

// 6. ì±„íŒ… ê¸°ëŠ¥ (ê¸°ì¡´ ìœ ì§€)
function sendChat() {
    if (!currentUser) return;
    const input = document.getElementById('chatInput');
    if(!input.value.trim()) return;
    const box = document.getElementById('msgBox');
    const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    
    const msgHtml = `
        <div class="flex flex-col items-end animate-fade-in">
            <div class="bg-[#8a9a5b] text-black p-2.5 rounded-2xl rounded-tr-none max-w-[90%] font-medium shadow-lg">
                ${input.value}
            </div>
            <span class="text-[8px] text-gray-600 mt-1">${time}</span>
        </div>
    `;
    box.insertAdjacentHTML('beforeend', msgHtml);
    input.value = "";
    box.scrollTop = box.scrollHeight;
}
</script>
</body>
</html>
